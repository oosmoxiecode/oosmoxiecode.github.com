// xgui.js r2 - https://github.com/oosmoxiecode/xgui.js
var xgui=function(j){function h(a){t(a,!0)}function p(a){u(a,!0)}function l(a){v(a,!0)}function q(a){t(a)}function w(a){u(a)}function x(a){v(a)}function t(a,c){a.preventDefault();var b=a,d=1,e=0;c&&"undefined"==typeof a.changedTouches&&(a.changedTouches=[a]);c&&(d=a.changedTouches.length);for(var f=0;f<d;f++){c&&(b=a.changedTouches[f],e="undefined"!=typeof b.identifier?b.identifier:"undefined"!=typeof b.pointerId?b.pointerId:0);if(!s[e]){if(null!=m[e]){var i=k[m[e]];if("ColorPicker2"==i.name||"ColorPicker3"==
i.name){var g=n.relativeMouseCoords(b);i.mouseMove(g.x-i.x,g.y-i.y)}}break}g=n.relativeMouseCoords(b);i=k[m[e]];if("CheckBox"==i.name||"RadioButton"==i.name||"Button"==i.name||"ImageButton"==i.name||"Matrix"==i.name)break;if("Stepper"==i.name&&(i.mouseDownPlus||i.mouseDownMinus))break;i.mouseDown(g.x-i.x,g.y-i.y)}}function u(a,c){var b=a,d=1,e=0;c&&"undefined"==typeof a.changedTouches&&(a.changedTouches=[a]);c&&(d=a.changedTouches.length);for(var f=0;f<d;f++){c&&(b=a.changedTouches[f],e="undefined"!=
typeof b.identifier?b.identifier:"undefined"!=typeof b.pointerId?b.pointerId:0);var i=m[e];if(a.target==g||a.target==n)null!=m[e]?"InputText"!=k[m[e]].name&&"DropDown"!=k[m[e]].name&&a.preventDefault():a.preventDefault();for(var j=n.relativeMouseCoords(b),l=0;l<k.length;++l){var h=k[l];if(j.x>h.x&&j.x<h.x+h.width&&j.y>h.y&&j.y<h.y+h.height){h.mouseDown(j.x-h.x,j.y-h.y);s[e]=!0;null!=i&&(i=k[i],("ColorPicker2"==i.name||"ColorPicker3"==i.name)&&i.mouseUp());m[e]=h.id;break}}}}function v(a,c){var b=
0;c&&"undefined"==typeof a.changedTouches&&(a.changedTouches=[a]);if(c)for(var d=a.changedTouches,e=0;e<d.length;e++){if(b="undefined"!=typeof d[e].identifier?d[e].identifier:"undefined"!=typeof d[e].pointerId?d[e].pointerId:0,s[b]=!1,null!=m[b]){var f=k[m[b]];f.mouseUp(b)}}else s[b]=!1,null!=m[b]&&(f=k[m[b]],f.mouseUp(b))}void 0==j&&(j={});var g,n,a,y=j.id||"xgui_container",k=[],s={},m={},e=j.backgroundColor||"rgb(100, 100, 100)",f=j.frontColor||"rgb(230, 230, 230)",o=j.dimColor||"rgb(140, 140, 140)",
r;this.width=j.width||600;this.height=j.height||400;g=document.createElement("div");g.style.position=j.position||"relative";g.style.width=""+this.width+"px";g.style.height=""+this.height+"px";g.setAttribute("id",y);g.style.touchAction="none";n=document.createElement("canvas");n.width=this.width;n.height=this.height;a=n.getContext("2d");g.appendChild(n);this.disableEvents=function(){document.removeEventListener("touchmove",h,!1);g.removeEventListener("touchstart",p,!1);document.removeEventListener("touchend",
l,!1);document.removeEventListener("mousemove",q,!1);g.removeEventListener("mousedown",w,!1);document.removeEventListener("mouseup",x,!1);document.addEventListener("MSPointerMove",h,!1);g.addEventListener("MSPointerDown",p,!1);document.addEventListener("MSPointerUp",l,!1)};this.enableEvents=function(){document.addEventListener("touchmove",h,!1);g.addEventListener("touchstart",p,!1);document.addEventListener("touchend",l,!1);document.addEventListener("mousemove",q,!1);g.addEventListener("mousedown",
w,!1);document.addEventListener("mouseup",x,!1);document.addEventListener("MSPointerMove",h,!1);g.addEventListener("MSPointerDown",p,!1);document.addEventListener("MSPointerUp",l,!1)};this.enableEvents();Base=function c(a){this.constructor!=c&&(void 0==a&&(a={}),this.id=k.push(this)-1,this.x=a.x||0,this.y=a.y||0,this.updateInterval=a.updateInterval||200,this.lastUpdate=0)};Value=function(a){this.v=a;this.bindArray=[];this.both=this.receiver=!1};Value.prototype.bind=function(){var a=arguments[0];if("function"==
typeof a)this.bindArray.push(a);else if("object"==typeof a){for(var a=[a],b=1;b<arguments.length;++b)a.push(arguments[b]);this.bindArray.push(a)}else console.log("error")};Value.prototype.updateBind=function(a){for(var a=a||!1,b=0;b<this.bindArray.length;++b){var d=this.bindArray[b];if("function"==typeof d)d(this.v,a);else if("object"==typeof d)for(var e=d[0],f=1;f<d.length;++f)this.receiver?this.v=e[d[f]]:(this.both&&(this.v=e[d[f]]),e[d[f]]=this.v);else console.log("error")}};this.Matrix=function(a){Base.call(this,
a);this.name="Matrix";this.w=a.w||4;this.h=a.h||4;this.size=a.size||10;this.width=this.w*this.size+this.w-1;this.height=this.h*this.size+this.h-1;for(var b=[],d=0;d<this.h;++d){b[d]=[];for(var e=0;e<this.w;++e)b[d][e]=0}this.value=new Value(a.array||b);this.draw()};this.Matrix.prototype=new Base;this.Matrix.prototype.constructor=this.Matrix;this.Matrix.prototype.draw=function(){a.save();a.translate(this.x,this.y);a.clearRect(0,0,this.width,this.height);for(var c=0;c<this.h;++c)for(var b=0;b<this.w;++b)a.fillStyle=
e,a.fillRect(b*this.size+b,c*this.size+c,this.size,this.size),this.value.v[c][b]&&(a.fillStyle=f,a.fillRect(b*this.size+b+2,c*this.size+c+2,this.size-4,this.size-4));a.restore()};this.Matrix.prototype.mouseDown=function(a,b){var d=Math.floor(a/(this.size+1)),e=Math.floor(b/(this.size+1));this.value.v[e][d]=this.value.v[e][d]?0:1;this.value.updateBind();this.draw()};this.Matrix.prototype.mouseUp=function(){this.value.updateBind(!0)};this.RangeSlider=function(a){Base.call(this,a);this.name="RangeSlider";
this.mouseIsOver=!1;this.value1=new Value(a.value1||25);this.value2=new Value(a.value2||75);this.width=a.width||100;this.height=a.height||10;this.min=a.min||0;this.max=a.max||this.width;this.range=this.max-this.min;this.decimals=a.decimals||0;this.draw()};this.RangeSlider.prototype=new Base;this.RangeSlider.prototype.constructor=this.RangeSlider;this.RangeSlider.prototype.draw=function(){this.value1.v>this.max&&(this.value1.v=this.max);this.value1.v<this.min&&(this.value1.v=this.min);this.value2.v>
this.max&&(this.value2.v=this.max);this.value2.v<this.min&&(this.value2.v=this.min);this.value1.v>this.value2.v&&(this.value1.v=this.value2.v);this.value2.v<this.value1.v&&(this.value2.v=this.value1.v);a.save();a.translate(this.x,this.y);a.fillStyle=e;a.fillRect(0,0,this.width,this.height);var c=Math.round(0.5*Math.max(0,this.height-11));a.fillStyle=f;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.value1.v.toFixed(this.decimals),0,9+c);a.fillStyle=f;a.font="11px Arial";
a.textBaseline="alphabetic";a.textAlign="right";a.fillText(this.value2.v.toFixed(this.decimals),this.width-1,9+c);a.fillStyle=f;var b=this.getPositionFromValue(this.value1.v),d=this.getPositionFromValue(this.value2.v);a.fillRect(b,0,d-b,this.height);a.beginPath();a.rect(b,0,d-b,this.height);a.clip();a.fillStyle=e;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.value1.v.toFixed(this.decimals),0,9+c);a.fillStyle=e;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign=
"right";a.fillText(this.value2.v.toFixed(this.decimals),this.width-1,9+c);a.restore()};this.RangeSlider.prototype.setValueFromPosition=function(a,b){var d=this.range/this.width*a-(this.range-this.max);d>this.max&&(d=this.max);d<this.min&&(d=this.min);1==b?this.value1.v=d:this.value2.v=d};this.RangeSlider.prototype.getPositionFromValue=function(a){return(a-this.min)/this.range*this.width};this.RangeSlider.prototype.mouseDown=function(a){var b=this.getPositionFromValue(this.value1.v),d=this.getPositionFromValue(this.value2.v),
b=Math.abs(a-b),d=Math.abs(a-d);b<d?(this.setValueFromPosition(a,1),this.value1.updateBind()):(this.setValueFromPosition(a,2),this.value2.updateBind());this.draw()};this.RangeSlider.prototype.mouseUp=function(){this.value1.updateBind(!0);this.value2.updateBind(!0)};this.DropDown=function(a){Base.call(this,a);this.name="DropDown";this.values=a.values||["DropDown"];this.texts=a.texts||this.values;this.dropdown=document.createElement("select");this.dropdown.setAttribute("id",this.id);this.value=new Value(this.values[0]);
for(a=0;a<this.values.length;++a){var b=document.createElement("option");b.text=this.texts[a];b.value=this.values[a];this.dropdown.options.add(b)}a=document.createElement("canvas");a.width=16;a.height=16;b=a.getContext("2d");b.clearRect(0,0,16,16);b.fillStyle=o;b.fillRect(0,0,16,16);b.fillStyle=f;b.beginPath();b.moveTo(4.5,6);b.lineTo(12.5,6);b.lineTo(8.5,11);b.lineTo(4.5,6);b.closePath();b.fill();b.strokeStyle=e;b.beginPath();b.moveTo(0,0);b.lineTo(0,16);b.closePath();b.stroke();b.beginPath();b.moveTo(16,
0);b.lineTo(16,16);b.closePath();b.stroke();this.div=document.createElement("div");this.div.setAttribute("id","input"+this.id);this.div.style.position="absolute";this.div.style.overflow="hidden";this.div.style.left=this.x-1+"px";this.div.style.top=this.y-1+"px";this.div.style.width="101px";this.div.style.height="16px";this.div.style.background="url('"+a.toDataURL("image/png")+"') no-repeat right "+f+"";this.dropdown.style.position="absolute";this.dropdown.style.left="0px";this.dropdown.style.top=
"0px";this.dropdown.style.borderWidth="1px";this.dropdown.style.fontFamily="sans-serif";this.dropdown.style.fontSize="10px";this.dropdown.style.outlineStyle="none";this.dropdown.style.color=e;this.dropdown.style.webkitAppearance="none";this.dropdown.style.borderRadius="0px";this.dropdown.style.background="rgba(0,0,0,0)";this.dropdown.style.borderStyle="solid";this.dropdown.style.width="121px";this.dropdown.style.height="16px";this.dropdown.style.textIndent="0px";this.dropdown.style.borderLeftColor=
e;this.dropdown.style.borderTopColor=e;this.dropdown.style.borderRightColor=e;this.dropdown.style.borderBottomColor=e;g.appendChild(this.div);this.div.appendChild(this.dropdown);this.dropdown.onchange=this.onChange;this.dropdown.onfocus=this.onFocus;this.draw()};this.DropDown.prototype=new Base;this.DropDown.prototype.constructor=this.DropDown;this.DropDown.prototype.onChange=function(){var a=k[this.id];a.value.v=this.value;a.value.updateBind()};this.DropDown.prototype.onFocus=function(){};this.DropDown.prototype.draw=
function(){};this.DropDown.prototype.mouseDown=function(){};this.DropDown.prototype.mouseUp=function(){};this.InputText=function(a){Base.call(this,a);this.name="InputText";this.text=a.text||"";this.input=document.createElement("input");this.value=new Value(this.text);this.input.value=this.value.v;this.input.type="text";this.input.setAttribute("id",this.id);this.input.style.position="absolute";this.input.style.left=this.x-1+"px";this.input.style.top=this.y-1+"px";this.input.style.borderWidth="1px";
this.input.style.fontFamily="sans-serif";this.input.style.fontSize="10px";this.input.style.outlineStyle="none";this.input.style.color=e;this.input.style.backgroundColor=f;this.input.style.borderStyle="solid";this.input.style.width="100px";this.input.style.height="12px";this.input.style.marginLeft="0px";this.input.style.textIndent="3px";this.input.style.webkitAppearance="none";this.input.style.borderRadius="0px";this.input.style.borderLeftColor=e;this.input.style.borderTopColor=e;this.input.style.borderRightColor=
e;this.input.style.borderBottomColor=e;this.input.oninput=this.onTextChange;this.input.onfocus=this.onFocus;g.appendChild(this.input);this.draw()};this.InputText.prototype=new Base;this.InputText.prototype.constructor=this.InputText;this.InputText.prototype.draw=function(){};this.InputText.prototype.onTextChange=function(){var a=k[this.id];a.value.v=this.value;a.value.updateBind()};this.InputText.prototype.onFocus=function(){};this.InputText.prototype.mouseDown=function(){};this.InputText.prototype.mouseUp=
function(){};this.Stepper=function(a){Base.call(this,a);this.name="Stepper";this.mouseIsOver=!1;this.value=new Value(a.value||0);this.width=a.width||60;this.height=a.height||10;this.min=a.min||-1E4;this.max=a.max||1E4;this.mouseDownPlus=this.mouseDownMinus=this.mouseDownNumber=!1;this.lastMouseY=this.lastMouseX=null;this.step=a.step||10;this.decimals=a.decimals||0;this.bx=this.width-22;this.draw()};this.Stepper.prototype=new Base;this.Stepper.prototype.constructor=this.Stepper;this.Stepper.prototype.draw=
function(){this.value.v<this.min&&(this.value.v=this.min);this.value.v>this.max&&(this.value.v=this.max);a.save();a.translate(this.x,this.y);a.fillStyle=e;a.fillRect(0,0,this.width,this.height);var c=Math.round(0.5*Math.max(0,this.height-11));a.fillStyle=f;this.mouseDownMinus&&(a.fillStyle=e);a.fillRect(this.bx,1,10,this.height-2);a.fillStyle=e;this.mouseDownMinus&&(a.fillStyle=f);a.fillRect(this.bx+2,4+c,6,2);a.fillStyle=f;this.mouseDownPlus&&(a.fillStyle=e);a.fillRect(this.bx+11,1,10,this.height-
2);a.fillStyle=e;this.mouseDownPlus&&(a.fillStyle=f);a.fillRect(this.bx+13,4+c,6,2);a.fillRect(this.bx+15,2+c,2,6);a.fillStyle=f;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="center";a.fillText(this.value.v.toFixed(this.decimals),this.bx/2,9+c);a.restore()};this.Stepper.prototype.mouseDown=function(a,b){a<this.bx&&!this.mouseDownMinus&&!this.mouseDownPlus?(this.mouseDownNumber=!0,this.mouseDownPlus=this.mouseDownMinus=!1):a>=this.bx&&a<this.bx+11&&!this.mouseDownNumber&&!this.mouseDownPlus?
(this.mouseDownMinus=!0,this.mouseDownPlus=this.mouseDownNumber=!1,this.value.v-=this.step):a>=this.bx+11&&(!this.mouseDownNumber&&!this.mouseDownMinus)&&(this.mouseDownPlus=!0,this.mouseDownMinus=this.mouseDownNumber=!1,this.value.v+=this.step);null!=this.lastMouseX&&this.mouseDownNumber&&(this.value.v+=(a-this.lastMouseX-(b-this.lastMouseY))*this.step,this.draw());this.lastMouseX=a;this.lastMouseY=b;this.draw();this.value.updateBind()};this.Stepper.prototype.mouseUp=function(){this.mouseDownPlus=
this.mouseDownMinus=this.mouseDownNumber=!1;this.lastMouseY=this.lastMouseX=null;this.value.updateBind(!0);this.draw()};this.Graph=function(a){Base.call(this,a);this.name="Graph";this.width=a.width||100;this.height=a.height||40;this.min=a.min||0;this.max=a.max||1;this.range=this.max-this.min;this.value=new Value(this.min);this.draw()};this.Graph.prototype=new Base;this.Graph.prototype.constructor=this.Graph;this.Graph.prototype.draw=function(){this.value.v>this.max&&(this.value.v=this.max);this.value.v<
this.min&&(this.value.v=this.min);var c=a.getImageData(this.x,this.y,this.width,this.height);a.strokeStyle=e;a.lineWidth=2;a.strokeRect(this.x,this.y,this.width,this.height);a.fillStyle=f;a.fillRect(this.x,this.y,this.width,this.height);a.save();a.beginPath();a.rect(this.x,this.y,this.width,this.height);a.clip();var b=document.createElement("canvas");b.width=this.width;b.height=this.height;b.getContext("2d").putImageData(c,0,0);a.drawImage(b,this.x-1,this.y);a.fillStyle=o;c=this.height/this.range*
(this.value.v+Math.abs(this.min));a.fillRect(this.x+this.width-1,this.y+this.height-c,1,c);a.restore()};this.Graph.prototype.mouseDown=function(){};this.Graph.prototype.mouseUp=function(){};this.ImageButton=function(a){Base.call(this,a);this.name="ImageButton";this.image=a.image||new Image;this.width=a.width||this.image.width;this.height=a.height||this.image.height;this.mouseIsDown=!1;this.value=new Value(this.mouseIsDown);this.draw()};this.ImageButton.prototype=new Base;this.ImageButton.prototype.constructor=
this.ImageButton;this.ImageButton.prototype.draw=function(){a.clearRect(this.x,this.y,this.width,this.height);a.globalAlpha=this.mouseIsDown?0.5:1;a.drawImage(this.image,this.x,this.y,this.width,this.height);a.globalAlpha=1};this.ImageButton.prototype.mouseDown=function(){this.mouseIsDown=!0;this.value.v=this.mouseIsDown;this.value.updateBind();this.draw()};this.ImageButton.prototype.mouseUp=function(){this.value.updateBind(!0);this.mouseIsDown=!1;this.value.v=this.mouseIsDown;this.value.updateBind();
this.draw()};this.Button=function(a){Base.call(this,a);this.name="Button";this.width=this.fullWidth=0;this.height=Math.max(a.height,14)||14;this.text=a.text||"";this.mouseIsDown=!1;this.value=new Value(this.mouseIsDown);this.draw();this.draw()};this.Button.prototype=new Base;this.Button.prototype.constructor=this.Button;this.Button.prototype.draw=function(){a.save();a.translate(this.x,this.y);a.strokeStyle=e;a.lineWidth=2;a.strokeRect(0,0,this.width,this.height);a.fillStyle=f;this.mouseIsDown&&(a.fillStyle=
o);a.fillRect(0,0,this.width,this.height);var c=Math.round(0.5*Math.max(0,this.height-14));a.fillStyle=e;this.mouseIsDown&&(a.fillStyle=f);a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.text,4,11+c);c=a.measureText(this.text);this.width=Math.round(this.fullWidth+c.width)+9;a.restore()};this.Button.prototype.mouseDown=function(){this.mouseIsDown=!0;this.value.v=this.mouseIsDown;this.value.updateBind();this.draw()};this.Button.prototype.mouseUp=function(){this.value.updateBind(!0);
this.mouseIsDown=!1;this.value.v=this.mouseIsDown;this.draw()};this.TrackPad=function(a){Base.call(this,a);this.name="TrackPad";this.width=a.width||100;this.height=a.height||60;this.min=a.min||-1;this.max=a.max||1;this.size=a.size||6;this.range=this.max-this.min;var b=-1*(this.range/2-this.max);this.value1=new Value(a.value1||b);this.value2=new Value(a.value2||b);this.draw()};this.TrackPad.prototype=new Base;this.TrackPad.prototype.constructor=this.TrackPad;this.TrackPad.prototype.draw=function(){this.value1.v<
this.min&&(this.value1.v=this.min);this.value1.v>this.max&&(this.value1.v=this.max);this.value2.v<this.min&&(this.value2.v=this.min);this.value2.v>this.max&&(this.value2.v=this.max);a.save();a.translate(this.x,this.y);a.clearRect(-1,0,this.width,this.height+14);a.strokeStyle=e;a.lineWidth=2;a.strokeRect(0,0,this.width,this.height);a.fillStyle=f;a.fillRect(0,0,this.width,this.height);a.strokeStyle=o;a.lineWidth=1;a.beginPath();a.moveTo(0,0.5+this.height/2);a.lineTo(0+this.width,0.5+this.height/2);
a.closePath();a.stroke();a.beginPath();a.moveTo(0.5+this.width/2,0);a.lineTo(0.5+this.width/2,this.height);a.closePath();a.stroke();var c=Math.round(this.getXPositionFromValue()),b=Math.round(this.getYPositionFromValue()),d=this.size/2;c<d&&(c=d);c>this.width-d&&(c=this.width-d);b<d&&(b=d);b>this.height-d&&(b=this.height-d);a.fillStyle=o;a.fillRect(c-d,b-d,this.size,this.size);a.fillStyle=e;a.font="8px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText("X: "+this.value1.v.toFixed(2)+
" Y: "+this.value2.v.toFixed(2),0,this.height+9);a.restore()};this.TrackPad.prototype.setXValueFromPosition=function(a){this.value1.v=this.range/this.width*a-(this.range-this.max)};this.TrackPad.prototype.setYValueFromPosition=function(a){this.value2.v=this.range/this.height*a-(this.range-this.max)};this.TrackPad.prototype.getXPositionFromValue=function(){return(this.value1.v-this.min)/this.range*this.width};this.TrackPad.prototype.getYPositionFromValue=function(){return(this.value2.v-this.min)/this.range*
this.height};this.TrackPad.prototype.mouseDown=function(a,b){this.setXValueFromPosition(a);this.setYValueFromPosition(b);this.draw();this.value1.updateBind();this.value2.updateBind()};this.TrackPad.prototype.mouseUp=function(){this.value1.updateBind(!0);this.value2.updateBind(!0)};this.ColorPicker=function(a){Base.call(this,a);this.name="ColorPicker";this.framewidth=a.framewidth||10;this.frameheight=a.frameheight||10;this.width=a.width||100;this.height=a.height||20;this.r=a.r||0===a.r?a.r:255;this.g=
a.g||0===a.g?a.g:255;this.b=a.b||0===a.b?a.b:255;this.hex=a.hex||colorToHex("rgb("+this.r+","+this.g+","+this.b+")");this.value=new Value(this.hex);this.draw()};this.ColorPicker.prototype=new Base;this.ColorPicker.prototype.constructor=this.ColorPicker;this.ColorPicker.prototype.draw=function(){a.save();a.translate(this.x,this.y);a.clearRect(0,0,this.width,this.height+this.frameheight+4);a.strokeStyle=e;a.lineWidth=2;a.strokeRect(0,0,this.width,this.height);var c=a.createLinearGradient(0,0,this.width,
0),b=1/6,d=0;c.addColorStop(b*d++,"rgb(255, 0, 0)");c.addColorStop(b*d++,"rgb(255, 255, 0)");c.addColorStop(b*d++,"rgb(0, 255, 0)");c.addColorStop(b*d++,"rgb(0, 255, 255)");c.addColorStop(b*d++,"rgb(0, 0, 255)");c.addColorStop(b*d++,"rgb(255, 0, 255)");c.addColorStop(b*d++,"rgb(255, 0, 0)");a.fillStyle=c;a.fillRect(0,0,this.width,this.height);b=1/(this.height/2);c=a.createLinearGradient(0,0,0,this.height/2);c.addColorStop(0,"rgba(255, 255, 255, 1)");c.addColorStop(b,"rgba(255, 255, 255, 1)");c.addColorStop(1,
"rgba(255, 255, 255, 0)");a.fillStyle=c;a.fillRect(0,0,this.width,this.height/2);c=a.createLinearGradient(0,0+this.height/2,0,this.height);c.addColorStop(0,"rgba(0, 0, 0, 0)");c.addColorStop(1-b,"rgba(0, 0, 0, 1)");c.addColorStop(1,"rgba(0, 0, 0, 1)");a.fillStyle=c;a.fillRect(0,this.height/2,this.width,this.height/2);a.strokeStyle=e;a.lineWidth=2;a.strokeRect(0,this.height+4,this.framewidth,this.frameheight);a.fillStyle="#"+this.value.v;a.fillRect(0,this.height+4,this.framewidth,this.frameheight);
c=Math.round(0.5*Math.max(0,this.frameheight-10));a.fillStyle=e;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText("#"+this.value.v.toUpperCase(),this.framewidth+4,this.height+13+c);a.restore()};this.ColorPicker.prototype.mouseDown=function(c,b){0>c&&(c=0);c>this.width-1&&(c=this.width-1);0>b&&(b=0);b>this.height-1&&(b=this.height-1);var d=a.getImageData(this.x+c,this.y+b,1,1).data;this.r=d[0];this.g=d[1];this.b=d[2];this.hex=colorToHex("rgb("+this.r+","+this.g+","+this.b+
")");this.value.v=this.hex;this.value.updateBind();this.draw()};this.ColorPicker.prototype.mouseUp=function(){this.value.updateBind(!0)};this.ColorPicker2=function(a){Base.call(this,a);this.name="ColorPicker2";this.framewidth=a.framewidth||10;this.frameheight=a.frameheight||10;this.colorwidth=a.width||100;this.colorheight=a.height||30;this.width=this.framewidth;this.height=this.frameheight;this.r=a.r||0===a.r?a.r:255;this.g=a.g||0===a.g?a.g:255;this.b=a.b||0===a.b?a.b:255;this.oldColor={r:this.r,
g:this.g,b:this.b};this.mousehack=this.open=!1;this.lastTime=0;this.hex=a.hex||colorToHex("rgb("+this.r+","+this.g+","+this.b+")");this.value=new Value(this.hex);this.draw()};this.ColorPicker2.prototype=new Base;this.ColorPicker2.prototype.constructor=this.ColorPicker2;this.ColorPicker2.prototype.draw=function(){a.save();a.translate(this.x,this.y);a.clearRect(-1,-1,this.framewidth+60,this.height+3);a.clearRect(-1,this.frameheight,this.colorwidth+2,this.colorheight+3);a.strokeStyle=e;a.lineWidth=2;
a.strokeRect(0,0,this.framewidth,this.frameheight);a.fillStyle="#"+this.value.v;a.fillRect(0,0,this.framewidth,this.frameheight);var c=Math.round(0.5*Math.max(0,this.frameheight-11));a.fillStyle=e;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText("#"+this.value.v.toUpperCase(),this.framewidth+4,9+c);if(this.open){a.strokeStyle=e;a.lineWidth=2;a.strokeRect(0,this.frameheight+1,this.colorwidth,this.colorheight);var c=a.createLinearGradient(0,this.frameheight+1,this.colorwidth,
this.frameheight+1),b=1/6,d=0;c.addColorStop(b*d++,"rgb(255, 0, 0)");c.addColorStop(b*d++,"rgb(255, 255, 0)");c.addColorStop(b*d++,"rgb(0, 255, 0)");c.addColorStop(b*d++,"rgb(0, 255, 255)");c.addColorStop(b*d++,"rgb(0, 0, 255)");c.addColorStop(b*d++,"rgb(255, 0, 255)");c.addColorStop(b*d++,"rgb(255, 0, 0)");a.fillStyle=c;a.fillRect(0,this.frameheight+1,this.colorwidth,this.colorheight);b=1/(this.colorheight/2);c=a.createLinearGradient(0,this.frameheight+1,0,this.frameheight+1+this.colorheight/2);
c.addColorStop(0,"rgba(255, 255, 255, 1)");c.addColorStop(b,"rgba(255, 255, 255, 1)");c.addColorStop(1,"rgba(255, 255, 255, 0)");a.fillStyle=c;a.fillRect(0,this.frameheight+1,this.colorwidth,this.colorheight/2);c=a.createLinearGradient(0,0+this.frameheight+1+this.colorheight/2,0,this.frameheight+1+this.colorheight);c.addColorStop(0,"rgba(0, 0, 0, 0)");c.addColorStop(1-b,"rgba(0, 0, 0, 1)");c.addColorStop(1,"rgba(0, 0, 0, 1)");a.fillStyle=c;a.fillRect(0,this.frameheight+1+this.colorheight/2,this.colorwidth,
this.colorheight/2)}a.restore()};this.ColorPicker2.prototype.mouseDown=function(a,b){if(!(200>(new Date).getTime()-this.lastTime)&&(this.open&&(0<a&&a<this.colorwidth-1&&b>this.frameheight&&b<this.frameheight+this.colorheight)&&(this.mouseMove(a,b),this.oldColor={r:this.r,g:this.g,b:this.b}),!this.open&&b<this.frameheight?this.open=!0:this.open&&(this.open=!1),this.open?(this.width=this.colorwidth,this.height=this.frameheight+this.colorheight):(this.width=this.framewidth,this.height=this.frameheight),
this.draw(),this.mousehack=!1,this.lastTime=(new Date).getTime(),!this.open))for(var d=0;d<k.length;++d)k[d].draw()};this.ColorPicker2.prototype.setOldColor=function(){this.r=this.oldColor.r;this.g=this.oldColor.g;this.b=this.oldColor.b;this.hex=colorToHex("rgb("+this.r+","+this.g+","+this.b+")")};this.ColorPicker2.prototype.mouseMove=function(c,b){var d=!1;0>c&&(c=0,this.setOldColor(),d=!0);c>this.colorwidth-1&&(c=this.colorwidth-1,this.setOldColor(),d=!0);b<=this.frameheight&&(b=this.frameheight,
this.setOldColor(),d=!0);b>this.frameheight+this.colorheight&&(b=this.frameheight+this.colorheight,this.setOldColor(),d=!0);d||(d=a.getImageData(this.x+c,this.y+b,1,1).data,this.r=d[0],this.g=d[1],this.b=d[2],this.hex=colorToHex("rgb("+this.r+","+this.g+","+this.b+")"));this.value.v=this.hex;this.value.updateBind();this.draw()};this.ColorPicker2.prototype.mouseUp=function(a){this.open||(m[a]=null);this.mousehack&&(this.setOldColor(),this.mouseDown(),m[a]=null);this.mousehack=!0;this.value.updateBind(!0)};
this.ColorPicker3=function(a){Base.call(this,a);this.name="ColorPicker3";this.framewidth=a.framewidth||10;this.frameheight=a.frameheight||10;this.maxWidth=a.maxWidth||12;this.size=a.size||10;this.palette=a.palette||["ffffff","000000"];this.colorwidth=this.maxWidth*this.size;this.colorheight=Math.ceil(this.palette.length/this.maxWidth)*this.size;this.width=this.framewidth;this.height=this.frameheight;this.current=a.current||0;this.current>=this.palette.length&&(this.current=this.palette.length-1);
this.mousehack=this.open=!1;this.lastTime=0;this.oldColor=this.hex=this.palette[this.current];this.oldCurrent=this.current;this.value=new Value(this.hex);this.draw()};this.ColorPicker3.prototype=new Base;this.ColorPicker3.prototype.constructor=this.ColorPicker3;this.ColorPicker3.prototype.draw=function(){a.save();a.translate(this.x,this.y);a.clearRect(-1,-1,this.framewidth+60,this.height+3);a.clearRect(-1,this.frameheight,this.colorwidth+2,this.colorheight+3);a.strokeStyle=e;a.lineWidth=2;a.strokeRect(0,
0,this.framewidth,this.frameheight);a.fillStyle="#"+this.value.v;a.fillRect(0,0,this.framewidth,this.frameheight);var c=Math.round(0.5*Math.max(0,this.frameheight-11));a.fillStyle=e;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText("#"+this.value.v.toUpperCase(),this.framewidth+4,9+c);if(this.open){for(var b=c=0,d,f,g=0;g<this.palette.length;g++)if(g==this.current&&(d=c,f=b),a.strokeRect(c*this.size,this.frameheight+b*this.size+1,this.size,this.size),a.fillStyle="#"+this.palette[g],
a.fillRect(c*this.size,this.frameheight+b*this.size+1,this.size,this.size),++c,c>=this.maxWidth)c=0,++b;a.strokeStyle="#ffffff";a.lineWidth=2;a.strokeRect(d*this.size,this.frameheight+f*this.size+1,this.size,this.size)}a.restore()};this.ColorPicker3.prototype.setOldColor=function(){this.hex=this.oldColor;this.current=this.oldCurrent};this.ColorPicker3.prototype.mouseDown=function(a,b){if(!(200>(new Date).getTime()-this.lastTime)&&(this.open&&(0<a&&a<this.colorwidth-1&&b>this.frameheight&&b<this.frameheight+
this.colorheight)&&(this.mouseMove(a,b),this.oldColor=this.hex,this.oldCurrent=this.current),!this.open&&b<this.frameheight?this.open=!0:this.open&&(this.open=!1),this.open?(this.width=this.colorwidth,this.height=this.frameheight+this.colorheight):(this.width=this.framewidth,this.height=this.frameheight),this.draw(),this.mousehack=!1,this.lastTime=(new Date).getTime(),!this.open))for(var d=0;d<k.length;++d)k[d].draw()};this.ColorPicker3.prototype.mouseMove=function(c,b){var d=!1;0>c&&(c=0,this.setOldColor(),
d=!0);c>this.colorwidth-1&&(c=this.colorwidth-1,this.setOldColor(),d=!0);b<=this.frameheight&&(b=this.frameheight,this.setOldColor(),d=!0);b>=this.frameheight+this.colorheight&&(b=this.frameheight+this.colorheight,this.setOldColor(),d=!0);if(!d){var d=Math.floor(c/this.size),e=Math.floor((b-this.frameheight)/this.size),f=d*this.size+Math.ceil(0.5*this.size),g=e*this.size+Math.ceil(0.5*this.size);this.current=e*this.maxWidth+d;d=a.getImageData(this.x+1+f,this.y+this.frameheight+1+g,1,1).data;this.hex=
colorToHex("rgb("+d[0]+","+d[1]+","+d[2]+")")}this.value.v=this.hex;this.value.updateBind();this.draw()};this.ColorPicker3.prototype.mouseUp=function(a){this.open||(m[a]=null);this.mousehack&&(this.setOldColor(),this.mouseDown(),m[a]=null);this.mousehack=!0;this.value.updateBind(!0)};this.Knob=function(a){Base.call(this,a);this.name="Knob";this.radius=a.radius||15;this.width=2*this.radius;this.height=2*this.radius;this.min=a.min||0;this.max=a.max||100;this.range=this.max-this.min;this.value=new Value(a.value||
0);this.mPI=0.8*Math.PI;this.lastRotationValue=this.rotationValue=this.getRotationValue();this.decimals=a.decimals||0;this.draw()};this.Knob.prototype=new Base;this.Knob.prototype.constructor=this.Knob;this.Knob.prototype.getRotationValue=function(){return(this.value.v-this.min)/(this.max-this.min)*(this.mPI- -this.mPI)-this.mPI};this.Knob.prototype.draw=function(){this.value.v<this.min&&(this.value.v=this.min);this.value.v>this.max&&(this.value.v=this.max);a.save();a.translate(this.x,this.y);a.clearRect(-4,
-4,this.width+8,this.height+13);a.fillStyle=e;a.beginPath();a.arc(this.radius,this.radius,this.radius,0,2*Math.PI,!1);a.closePath();a.fill();var c=Math.PI+this.mPI,b=(c-(Math.PI-this.mPI))/this.radius;a.strokeStyle=e;a.lineWidth=0.5;for(var d=0;d<=this.radius;++d){var g=this.radius+Math.sin(c-b*d)*(this.radius+1),h=this.radius+Math.cos(c-b*d)*(this.radius+1),i=this.radius+Math.sin(c-b*d)*(this.radius+4),j=this.radius+Math.cos(c-b*d)*(this.radius+4);a.beginPath();a.moveTo(g,h);a.lineTo(i,j);a.closePath();
a.stroke()}c=this.radius+Math.cos(this.rotationValue-0.5*Math.PI)*this.radius;b=this.radius+Math.sin(this.rotationValue-0.5*Math.PI)*this.radius;a.strokeStyle=f;a.lineWidth=2;a.beginPath();a.moveTo(this.radius,this.radius);a.lineTo(c,b);a.closePath();a.stroke();a.fillStyle=e;a.font="8px Arial";a.textBaseline="alphabetic";a.textAlign="center";a.fillText(this.value.v.toFixed(this.decimals),this.radius,2*this.radius+7);a.restore()};this.Knob.prototype.mouseDown=function(a,b){this.rotationValue=-1*Math.atan2(this.radius-
a,this.radius-b);this.rotationValue>this.mPI&&(this.rotationValue=this.mPI);this.rotationValue<-this.mPI&&(this.rotationValue=-this.mPI);Math.abs(this.rotationValue-this.lastRotationValue)>Math.PI&&(this.rotationValue=this.lastRotationValue);this.value.v=this.range*(this.rotationValue- -this.mPI)*(1/(this.mPI- -this.mPI))+this.min;this.draw();this.value.updateBind();this.lastRotationValue=this.rotationValue};this.Knob.prototype.mouseUp=function(){this.value.updateBind(!0)};this.CheckBox=function(a){Base.call(this,
a);this.name="CheckBox";this.text=a.text||"";this.value=new Value(a.selected||!1);this.width=this.fullWidth=a.width||10;this.height=a.height||10;this.draw()};this.CheckBox.prototype=new Base;this.CheckBox.prototype.constructor=this.CheckBox;this.CheckBox.prototype.draw=function(){a.save();a.translate(this.x,this.y);a.clearRect(0,0,this.width,this.height);a.fillStyle=e;a.fillRect(0,0,this.fullWidth,this.height);a.fillStyle=this.value.v?f:e;a.fillRect(2,2,this.fullWidth-4,this.height-4);var c=Math.round(0.5*
Math.max(0,this.height-11));a.fillStyle=e;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.text,this.fullWidth+2,9+c);this.width=this.fullWidth+a.measureText(this.text).width+3;a.restore()};this.CheckBox.prototype.mouseDown=function(){this.value.v=this.value.v?!1:!0;this.value.updateBind();this.draw()};this.CheckBox.prototype.mouseUp=function(){this.value.updateBind(!0)};this.RadioButtonGroup=function(){this.name="RadioButtonGroup";this.array=[];this.value=new Value([])};
this.RadioButtonGroup.prototype.add=function(a){this.array.push(a);this.value.v.push(a.value.v);a.group=this};this.RadioButtonGroup.prototype.clear=function(a){for(var b=0;b<this.array.length;++b){var d=this.array[b];d==a?this.value.v[b]=!0:(this.value.v[b]=!1,d.value.v=!1,d.value.updateBind(),d.draw())}this.value.updateBind()};this.RadioButton=function(a){Base.call(this,a);this.name="RadioButton";this.group=null;this.text=a.text||"";this.value=new Value(a.selected||!1);this.width=this.fullWidth=
a.width||18;this.height=a.height||10;this.draw()};this.RadioButton.prototype=new Base;this.RadioButton.prototype.constructor=this.RadioButton;this.RadioButton.prototype.draw=function(){a.save();a.translate(this.x,this.y);a.clearRect(0,0,this.width,this.height);a.fillStyle=e;a.fillRect(0,0,this.fullWidth,this.height);this.value.v?(a.fillStyle=f,a.fillRect(this.fullWidth/2+1,2,this.fullWidth/2-3,this.height-4)):(a.fillStyle=o,a.fillRect(2,2,this.fullWidth/2-3,this.height-4));var c=Math.round(0.5*Math.max(0,
this.height-11));a.fillStyle=e;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.text,this.fullWidth+2,9+c);this.width=this.fullWidth+a.measureText(this.text).width+3;a.restore()};this.RadioButton.prototype.mouseDown=function(){this.group.clear(this);this.value.v||(this.value.v=!0);this.value.updateBind();this.draw()};this.RadioButton.prototype.mouseUp=function(){this.value.updateBind(!0)};this.RadioButton.prototype.mouseMove=function(){};this.HSlider=function(a){Base.call(this,
a);this.name="HSlider";this.mouseIsOver=!1;this.value=new Value(a.value||0);this.width=a.width||100;this.height=a.height||10;this.min=a.min||0;this.max=a.max||this.width;this.range=this.max-this.min;this.decimals=a.decimals||0;this.draw()};this.HSlider.prototype=new Base;this.HSlider.prototype.constructor=this.HSlider;this.HSlider.prototype.draw=function(){this.value.v>this.max&&(this.value.v=this.max);this.value.v<this.min&&(this.value.v=this.min);a.save();a.translate(this.x,this.y);a.fillStyle=
e;a.fillRect(0,0,this.width,this.height);var c=Math.round(0.5*Math.max(0,this.height-11));a.fillStyle=f;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.value.v.toFixed(this.decimals),0,9+c);var b=this.getPositionFromValue();a.fillStyle=f;a.fillRect(0,0,b,this.height);a.beginPath();a.rect(0,0,b,this.height);a.clip();a.fillStyle=e;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.value.v.toFixed(this.decimals),0,9+c);a.restore()};this.HSlider.prototype.setValueFromPosition=
function(a){this.value.v=this.range/this.width*a-(this.range-this.max)};this.HSlider.prototype.getPositionFromValue=function(){return(this.value.v-this.min)/this.range*this.width};this.HSlider.prototype.mouseDown=function(a){this.setValueFromPosition(a);this.draw();this.value.updateBind()};this.HSlider.prototype.mouseUp=function(){this.value.updateBind(!0)};this.VSlider=function(a){Base.call(this,a);this.name="VSlider";this.mouseIsOver=!1;this.value=new Value(a.value||0);this.width=a.width||10;this.height=
a.height||100;this.min=a.min||0;this.max=a.max||this.height;this.decimals=a.decimals||0;this.range=this.max-this.min;this.draw()};this.VSlider.prototype=new Base;this.VSlider.prototype.constructor=this.VSlider;this.VSlider.prototype.draw=function(){this.value.v>this.max&&(this.value.v=this.max);this.value.v<this.min&&(this.value.v=this.min);a.save();a.translate(this.x,this.y);a.fillStyle=e;a.fillRect(0,0,this.width,this.height);var c=Math.round(0.5*Math.max(0,this.width-11));a.save();a.translate(9+
c,this.height-1);a.rotate(-Math.PI/2);a.fillStyle=f;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.value.v.toFixed(this.decimals),0,0);a.restore();var b=this.getPositionFromValue();a.fillStyle=f;a.fillRect(0,b,this.width,this.height-b);a.translate(9+c,this.height-1);a.rotate(-Math.PI/2);a.beginPath();a.rect(-1,-this.width+1,this.height-b,this.width);a.clip();a.fillStyle=e;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.value.v.toFixed(this.decimals),
0,0);a.restore()};this.VSlider.prototype.setValueFromPosition=function(a){this.value.v=this.range-this.range/this.height*a-(this.range-this.max)};this.VSlider.prototype.getPositionFromValue=function(){return this.height-(this.value.v-this.min)/this.range*this.height};this.VSlider.prototype.mouseDown=function(a,b){this.setValueFromPosition(b);this.draw();this.value.updateBind()};this.VSlider.prototype.mouseUp=function(){this.value.updateBind(!0)};this.Joystick=function(a){Base.call(this,a);this.name=
"Joystick";this.value1=new Value(0);this.value2=new Value(0);this.radius=a.radius||50;this.innerRadius=a.innerRadius||0.65*this.radius;this.width=2*this.radius;this.height=2*this.radius;this.sticky=this.stickx=0;this.laststicky=this.laststickx=-1;this.maxDistance=this.radius-this.innerRadius-5;this.doUpdate=this.mouseIsDown=!1;this.draw()};this.Joystick.prototype=new Base;this.Joystick.prototype.constructor=this.Joystick;this.Joystick.prototype.draw=function(c){this.mouseIsDown||(this.stickx+=(0-
this.stickx)/3,this.sticky+=(0-this.sticky)/3);if(this.stickx.toFixed(2)==this.laststickx.toFixed(2)&&this.sticky.toFixed(2)==this.laststicky.toFixed(2)&&c)this.doUpdate=!1;else{this.doUpdate=!0;this.value1.v=this.stickx/this.maxDistance;this.value2.v=this.sticky/this.maxDistance;a.save();a.translate(this.x,this.y);a.clearRect(-2,-2,this.width+14,this.height+14);c=a.createRadialGradient(this.radius,this.radius,0,this.radius,this.radius,this.radius+5);c.addColorStop(0,o);c.addColorStop(0.8,f);c.addColorStop(1,
o);a.fillStyle=c;a.beginPath();a.arc(this.radius,this.radius,this.radius,0,2*Math.PI,!1);a.closePath();a.fill();var b=5*(1-this.value1.v),d=5*(1-this.value2.v),c=a.createRadialGradient(this.radius+this.stickx+b,this.radius+this.sticky+d,0,this.radius+this.stickx+b,this.radius+this.sticky+d,this.innerRadius+10);c.addColorStop(0,"rgba(0,0,0,1)");c.addColorStop(1,"rgba(0,0,0,0.00001)");a.fillStyle=c;a.beginPath();a.arc(this.radius+this.stickx+b,this.radius+this.sticky+d,this.innerRadius+10,0,2*Math.PI,
!1);a.closePath();a.fill();c=a.createLinearGradient(this.radius+this.stickx-this.innerRadius,this.radius+this.sticky-this.innerRadius,this.radius+this.stickx-this.innerRadius,this.radius+this.sticky+this.innerRadius);c.addColorStop(0,f);c.addColorStop(1,o);a.fillStyle=c;a.beginPath();a.arc(this.radius+this.stickx,this.radius+this.sticky,this.innerRadius,0,2*Math.PI,!1);a.closePath();a.fill();c=a.createRadialGradient(this.radius+this.stickx,this.radius+this.sticky,0,this.radius+this.stickx,this.radius+
this.sticky,this.radius);c.addColorStop(0,f);c.addColorStop(1,o);a.fillStyle=c;a.beginPath();a.arc(this.radius+this.stickx,this.radius+this.sticky,this.innerRadius-4,0,2*Math.PI,!1);a.closePath();a.fill();this.laststickx=this.stickx;this.laststicky=this.sticky;a.restore()}};this.Joystick.prototype.mouseDown=function(a,b){this.mouseIsDown=!0;this.stickx=a-this.radius;this.sticky=b-this.radius;if(Math.sqrt(this.stickx*this.stickx+this.sticky*this.sticky)>this.maxDistance){var d=Math.atan2(this.stickx,
this.sticky);this.stickx=Math.sin(d)*this.maxDistance;this.sticky=Math.cos(d)*this.maxDistance}this.draw();this.value1.updateBind();this.value2.updateBind()};this.Joystick.prototype.mouseUp=function(){this.mouseIsDown=!1;this.doUpdate=!0;this.value1.updateBind(!0);this.value2.updateBind(!0)};this.CircularSlider=function(a){Base.call(this,a);this.name="CircularSlider";this.radius=a.radius||25;this.innerRadius=a.innerRadius||this.radius-10;this.width=2*this.radius;this.height=2*this.radius;this.min=
a.min||0;this.max=a.max||100;this.range=this.max-this.min;this.value=new Value(a.value||0);this.lastRotationValue=this.rotationValue=this.getRotationValue();this.decimals=a.decimals||0;this.draw()};this.CircularSlider.prototype=new Base;this.CircularSlider.prototype.constructor=this.CircularSlider;this.CircularSlider.prototype.getRotationValue=function(){return(this.value.v-this.min)/(this.max-this.min)*2*Math.PI};this.CircularSlider.prototype.draw=function(){this.value.v<this.min&&(this.value.v=
this.min);this.value.v>this.max&&(this.value.v=this.max);a.save();a.translate(this.x,this.y);a.clearRect(0,0,this.width,this.height);a.fillStyle=e;a.beginPath();a.arc(this.radius,this.radius,this.radius,0.5*-Math.PI,1.5*Math.PI,!1);a.closePath();a.fill();a.fillStyle=f;a.beginPath();a.moveTo(this.radius,this.radius);a.lineTo(this.radius,0);a.arc(this.radius,this.radius,this.radius,0.5*-Math.PI,this.rotationValue-0.5*Math.PI,!1);a.closePath();a.fill();a.globalCompositeOperation="destination-out";a.beginPath();
a.arc(this.radius,this.radius,this.innerRadius,0.5*-Math.PI,1.5*Math.PI,!1);a.closePath();a.fill();a.globalCompositeOperation="source-over";a.fillStyle=e;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="center";a.fillText(this.value.v.toFixed(this.decimals),this.radius,this.radius+4);a.restore()};this.CircularSlider.prototype.mouseDown=function(a,b){this.rotationValue=Math.atan2(this.radius-b,this.radius-a)-0.5*Math.PI;var d=2*Math.PI;this.rotationValue=(this.rotationValue%d+d)%d;Math.abs(this.rotationValue-
this.lastRotationValue)>Math.PI&&(this.rotationValue=this.lastRotationValue);this.value.v=this.range*this.rotationValue*(1/d)+this.min;this.draw();this.value.updateBind();this.lastRotationValue=this.rotationValue};this.CircularSlider.prototype.mouseUp=function(){this.value.updateBind(!0)};this.Scrollwheel=function(a){Base.call(this,a);this.name="Scrollwheel";this.width=a.width||20;this.height=a.height||80;this.centerx=this.x+0.5*this.width;this.centery=this.y+0.5*this.height;this.min=a.min||-1;this.max=
a.max||1;this.range=this.max-this.min;this.value=new Value(a.value||0);this.lastValue=this.value.v;this.decimals=a.decimals||2;this.pattern=document.createElement("canvas");this.pattern.width=this.width;this.pattern.height=3*this.height;for(var a=this.pattern.getContext("2d"),b=[f,o],d=0;d<this.pattern.height;d+=2)a.fillStyle=b[0.5*d%2],a.fillRect(0,d,128,2);this.mouseStartY=null;this.offsetY=this.mouseOffsetY=0;this.doUpdate=!0;this.draw()};this.Scrollwheel.prototype=new Base;this.Scrollwheel.prototype.constructor=
this.Scrollwheel;this.Scrollwheel.prototype.draw=function(){this.value.v<this.min&&(this.value.v=this.min);this.value.v>this.max&&(this.value.v=this.max);this.offsetY+=(this.mouseOffsetY-this.offsetY)/10;a.save();a.translate(this.x,this.y);a.fillStyle=e;a.fillRect(0,0,this.width,this.height);a.save();a.beginPath();a.rect(2,2,this.width-4,this.height-4);a.clip();a.drawImage(this.pattern,0,-this.height+this.offsetY);a.restore();var c=a.createLinearGradient(0,0,0,this.height);c.addColorStop(0,"rgba(0,0,0,0.7)");
c.addColorStop(0.4,"rgba(0,0,0,0)");c.addColorStop(0.6,"rgba(0,0,0,0)");c.addColorStop(1,"rgba(0,0,0,0.7)");a.fillStyle=c;a.fillRect(0,0,this.width,this.height);this.value.v=(this.range*((this.offsetY+this.height)/(2*this.height))+this.min).toFixed(this.decimals);this.value.v!=this.lastValue?(this.value.updateBind(),this.doUpdate=!0):this.doUpdate=!1;this.lastValue=this.value.v;a.restore()};this.Scrollwheel.prototype.mouseDown=function(a,b){null==this.mouseStartY&&(this.mouseStartY=b);this.mouseOffsetY=
b-this.mouseStartY;this.mouseOffsetY>this.height&&(this.mouseOffsetY=this.height);this.mouseOffsetY<-this.height&&(this.mouseOffsetY=-this.height);this.draw()};this.Scrollwheel.prototype.mouseUp=function(){this.mouseStartY=null;this.mouseOffsetY=0;this.doUpdate=!0;this.value.updateBind(!0)};this.Label=function(a){Base.call(this,a);this.name="Label";this.group=null;this.value=new Value(a.text||"");this.width=0;this.height=13;this.draw()};this.Label.prototype=new Base;this.Label.prototype.constructor=
this.Label;this.Label.prototype.draw=function(){a.clearRect(this.x,this.y,this.width,this.height);a.fillStyle=e;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.value.v,this.x,this.y+9);this.width=a.measureText(this.value.v).width+3};this.Label.prototype.mouseDown=function(){};this.Label.prototype.mouseUp=function(){};this.onResize=function(){g.style.width=""+this.width+"px";g.style.height=""+this.height+"px";n.width=this.width;n.height=this.height};this.dispose=
function(){this.disableEvents();k.length=0;g.removeChild(n);g.innerHTML="";document.getElementById(y).parentNode.removeChild(g);for(var a in this)delete this[a]};this.update=function(){r=Date.now();for(var a=0;a<k.length;++a){var b=k[a];if("Joystick"==b.name||"Scrollwheel"==b.name)b.doUpdate&&b.draw(!0);else{if(b.value&&(b.value.receiver||b.value.both)&&r>b.lastUpdate+b.updateInterval)b.value.updateBind(),b.draw(),b.lastUpdate=r;if(b.value1){var d=!1;if((b.value1.receiver||b.value1.both)&&r>b.lastUpdate+
b.updateInterval)b.value1.updateBind(),d=!0;if((b.value2.receiver||b.value2.both)&&r>b.lastUpdate+b.updateInterval)b.value2.updateBind(),d=!0;d&&(b.draw(),b.lastUpdate=r)}}}};return{getDomElement:function(){return g},getContext:function(){return a},HSlider:this.HSlider,VSlider:this.VSlider,Label:this.Label,RadioButton:this.RadioButton,RadioButtonGroup:this.RadioButtonGroup,CheckBox:this.CheckBox,Knob:this.Knob,ColorPicker:this.ColorPicker,ColorPicker2:this.ColorPicker2,ColorPicker3:this.ColorPicker3,
TrackPad:this.TrackPad,Button:this.Button,ImageButton:this.ImageButton,Graph:this.Graph,Stepper:this.Stepper,InputText:this.InputText,DropDown:this.DropDown,Matrix:this.Matrix,RangeSlider:this.RangeSlider,Joystick:this.Joystick,CircularSlider:this.CircularSlider,Scrollwheel:this.Scrollwheel,update:this.update,onResize:this.onResize,disableEvents:this.disableEvents,enableEvents:this.enableEvents,dispose:this.dispose}};
function colorToHex(j){var h=/rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/.exec(j);return h?(16777216|h[1]<<16|h[2]<<8|h[3]).toString(16).substr(1):j}HTMLCanvasElement.prototype.relativeMouseCoords=function(j){var h=0,p=0,l=0,q=0,l=this;do h+=l.offsetLeft,p+=l.offsetTop;while(l=l.offsetParent);l=j.pageX-h;q=j.pageY-p;l=Math.round(l*(this.width/this.offsetWidth));q=Math.round(q*(this.height/this.offsetHeight));return{x:l,y:q}};
